Contributions are welcome, but be aware that the existing internal code is a bit of a mess.
